!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["carousel-view"]={})}(this,(function(t){"use strict";function e(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var n="vertical",r="horizontal";function s(t,e,i,n,r,s,o,a,h,u){"boolean"!=typeof o&&(h=a,a=o,o=!1);const l="function"==typeof i?i.options:i;let c;if(t&&t.render&&(l.render=t.render,l.staticRenderFns=t.staticRenderFns,l._compiled=!0,r&&(l.functional=!0)),n&&(l._scopeId=n),s?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,h(t)),t&&t._registeredComponents&&t._registeredComponents.add(s)},l._ssrRegister=c):e&&(c=o?function(t){e.call(this,u(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),c)if(l.functional){const t=l.render;l.render=function(e,i){return c.call(i),t(e,i)}}else{const t=l.beforeCreate;l.beforeCreate=t?[].concat(t,c):[c]}return i}const o={name:"carouselView",props:{direction:{type:String,default:r,validator:function(t){return[n,r].indexOf(t)>-1}},mousewheelControl:{type:Boolean,default:!0},performanceMode:{type:Boolean,default:!1},paginationVisible:{type:Boolean,default:!0},paginationClickable:{type:Boolean,default:!1},loop:{type:Boolean,default:!0},speed:{type:Number,default:300},autoHeight:{type:Boolean,default:!0},autoWidth:{type:Boolean,default:!0},indicatorColor:{type:String,default:function(){return"rgba(153, 153, 153, 0.5)"}},indicatorTintColor:{type:String,default:function(){return"#007aff"}}},data:function(){return{ref:void 0,currentPage:1,lastPage:1,translateX:0,translateY:0,startTranslate:0,delta:0,dragging:!1,startPos:null,transitioning:!1,slideEls:[],translateOffset:0,transitionDuration:0,currentHeight:"unset",currentWidth:"unset"}},created:function(){this.ref=this._uniq()},mounted:function(){this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this.slideEls=[].map.call(this.$refs[this.ref].children,(function(t){return t})),this.loop?(this.$nextTick((function(){this._createLoop(),this.setPage(this.currentPage,!0)})),this._initObserver()):this.setPage(this.currentPage)},beforeDestroy:function(){this._unObserver()},methods:{_uniq:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return(16777215*Math.random()<<t).toString(16)},_initObserver:function(){var t=window.MutationObserver||window.WebKitMutationObserver;this.observer=new t(this._updateLoop),this.observer.observe(document.querySelector(".crsl__wr"),{subtree:!0,childList:!0,attributes:!0})},_unObserver:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this._removeListeners()},_removeListeners:function(){document.removeEventListener("touchmove",this._onTouchMove),document.removeEventListener("touchend",this._onTouchEnd),document.removeEventListener("mousemove",this._onTouchMove),document.removeEventListener("mouseup",this._onTouchEnd)},next:function(){var t=this.currentPage;t<this.slideEls.length||this.loop?this.setPage(t+1):this._revert()},prev:function(){var t=this.currentPage;t>1||this.loop?this.setPage(t-1):this._revert()},setPage:function(t,e){var i=this;this.lastPage=this.currentPage,0===t?this.currentPage=this.slideEls.length:t===this.slideEls.length+1?this.currentPage=1:this.currentPage=t,this.loop?(0===this.delta&&this._setTranslate(i._getTranslateOfPage(this.lastPage)),setTimeout((function(){i._setTranslate(i._getTranslateOfPage(t)),e||i._onTransitionStart()}),0)):(this._setTranslate(this._getTranslateOfPage(t)),e||this._onTransitionStart())},isHorizontal:function(){return this.direction===r},isVertical:function(){return this.direction===n},_onTouchStart:function(t){this.startPos=this._getTouchPos(t),this.delta=0,this.startTranslate=this._getTranslateOfPage(this.currentPage),this.startTime=(new Date).getTime(),this.dragging=!0,this.transitionDuration=0,document.addEventListener("touchmove",this._onTouchMove,{passive:!1}),document.addEventListener("touchend",this._onTouchEnd,{passive:!1}),document.addEventListener("mousemove",this._onTouchMove,{passive:!1}),document.addEventListener("mouseup",this._onTouchEnd,{passive:!1})},_onTouchMove:function(t){this.delta=this._getTouchPos(t)-this.startPos,this.performanceMode||(this._setTranslate(this.startTranslate+this.delta),this.$emit("slider-move",this._getTranslate())),(this.isVertical()||this.isHorizontal()&&Math.abs(this.delta)>0)&&t.preventDefault()},_onTouchEnd:function(t){this.dragging=!1,this.transitionDuration=this.speed;var e=(new Date).getTime()-this.startTime<1e3;this.delta<-100||e&&this.delta<-15?this.next():this.delta>100||e&&this.delta>15?this.prev():this._revert(),this._removeListeners()},_onWheel:function(t){this.mousewheelControl&&(this.transitioning||(t.deltaY>0?this.next():this.prev()),this._isPageChanged()&&t.preventDefault())},_revert:function(){this.setPage(this.currentPage)},_getTouchPos:function(t){var e=this.isHorizontal()?"pageX":"pageY";return t.changedTouches?t.changedTouches[0][e]:t[e]},_onTransitionStart:function(){this.transitioning=!0,this.transitionDuration=this.speed,this._isPageChanged()?this.$emit("slide-change-start",this.currentPage):this.$emit("slide-revert-start",this.currentPage)},_onTransitionEnd:function(){this.transitioning=!1,this.transitionDuration=0,this.delta=0,this._isPageChanged()?this.$emit("slide-change-end",this.currentPage):this.$emit("slide-revert-end",this.currentPage),this.autoHeight&&this.isHorizontal()&&this._toggleHeight(),this.autoWidth&&this.isVertical()&&this._toggleWidth()},_toggleHeight:function(){var t=this,i=this.$refs[this.ref];if(i&&i.children){this.currentHeight="auto";var n=e(i.children).filter((function(t){return!e(t.classList).includes("crsl__mirror")})),r=getComputedStyle(n[this.currentPage-1],null).getPropertyValue("height");this.transitionDuration=this.speed,this.$nextTick((function(){t.currentHeight=r,setTimeout((function(){t.transitionDuration=0}),t.speed)}))}},_toggleWidth:function(){var t=this,i=this.$refs[this.ref];if(i&&i.children){this.currentWidth="auto";var n=e(i.children).filter((function(t){return!e(t.classList).includes("crsl__mirror")})),r=getComputedStyle(n[this.currentPage-1],null).getPropertyValue("width");this.transitionDuration=this.speed,this.$nextTick((function(){t.currentWidth=r,setTimeout((function(){t.transitionDuration=0}),t.speed)}))}},_isPageChanged:function(){return this.lastPage!==this.currentPage},_setTranslate:function(t){this[this.isHorizontal()?"translateX":"translateY"]=t},_getTranslate:function(){return this[this.isHorizontal()?"translateX":"translateY"]},_getTranslateOfPage:function(t){if(0===t)return 0;var e=this.isHorizontal()?"clientWidth":"clientHeight";return-[].reduce.call(this.slideEls,(function(i,n,r){return r>t-2?i:i+n[e]}),0)+this.translateOffset},_createLoop:function(){var t=this.isHorizontal()?"clientWidth":"clientHeight",e=this.$refs[this.ref];if(e){var i=e.firstElementChild.cloneNode(!0),n=e.lastElementChild.cloneNode(!0);i.setAttribute("class","crsl__mirror crsl__mirror-first"),n.setAttribute("class","crsl__mirror crsl__mirror-last"),e.insertBefore(n,e.firstElementChild),e.appendChild(i),this.translateOffset=-n[t]}},_updateLoop:function(t,e){var i=this,n=this.$refs[this.ref];if(n&&!t.some((function(t){return t.target===n}))){var r=n.querySelectorAll(".crsl__mirror");if(r&&r.length){for(var s=function(t,e){i.$nextTick((function(){return r[t].remove()}))},o=0,a=r.length>>>0;o<a;o++)s(o);this.$nextTick((function(){return i._createLoop()}))}}}}};var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"crsl__wrapper",class:[t.direction,{dragging:t.dragging}],on:{touchstart:t._onTouchStart,mousedown:t._onTouchStart,wheel:t._onWheel}},[i("div",{ref:t.ref,staticClass:"crsl__wr",style:{transform:"translate3d("+t.translateX+"px,"+t.translateY+"px, 0)","transition-duration":t.transitionDuration+"ms","max-height":t.currentHeight,"max-width":t.currentWidth},on:{transitionend:t._onTransitionEnd}},[t._t("default")],2),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.paginationVisible,expression:"paginationVisible"}],staticClass:"crsl__pagination"},t._l(t.slideEls,(function(e,n){return i("span",{key:n,staticClass:"crsl__pagination-bullet",class:{active:n+1===t.currentPage},style:{background:n+1===t.currentPage?t.indicatorTintColor:t.indicatorColor},on:{click:function(e){t.paginationClickable&&t.setPage(n+1)}}})})),0)])};a._withStripped=!0;const h=s({render:a,staticRenderFns:[]},undefined,o,"data-v-3a776d89",false,undefined,!1,void 0,void 0,void 0);var u=[h],l=function(t){u.forEach((function(e){t.component(e.name,e)}))};"undefined"!=typeof window&&window.Vue&&l(window.Vue),t.CarouselView=h,t.default=l,Object.defineProperty(t,"__esModule",{value:!0})}));
