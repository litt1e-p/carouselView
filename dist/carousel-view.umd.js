(function(u,n){typeof exports=="object"&&typeof module!="undefined"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):n((u=typeof globalThis!="undefined"?globalThis:u||self)["carousel-view"]=u["carousel-view"]||{},u.Vue)})(this,function(u,n){"use strict";const S={class:"crsl__pagination"},L=["onClick"];var y=((l,s)=>{for(const[a,c]of s)l[a]=c;return l})(Object.assign({name:"CarouselView"},{props:{direction:{type:String,default:"horizontal",validator:l=>["vertical","horizontal"].indexOf(l)>-1},mousewheelControl:{type:Boolean,default:!0},performanceMode:{type:Boolean,default:!1},paginationVisible:{type:Boolean,default:!0},paginationClickable:{type:Boolean,default:!1},loop:{type:Boolean,default:!0},speed:{type:Number,default:300},autoHeight:{type:Boolean,default:!0},autoWidth:{type:Boolean,default:!0},indicatorColor:{type:String,default:()=>"rgba(153, 153, 153, 0.5)"},indicatorTintColor:{type:String,default:()=>"#007aff"}},emits:["slider-move","slide-change-start","slide-revert-start","slide-change-end","slide-revert-end"],setup:function(l,{emit:s}){const a=l,c=n.ref(null),e=n.reactive({currentPage:1,lastPage:1,translateX:0,translateY:0,startTranslate:0,delta:0,dragging:!1,startPos:null,transitioning:!1,slideEls:[],translateOffset:0,transitionDuration:0,currentHeight:"unset",currentWidth:"unset",startTime:0,observer:void 0});n.onMounted(()=>{e.slideEls=[].map.call(c.value.children,t=>t),a.loop?(n.nextTick(function(){x(),f(e.currentPage,!0)}),W()):f(e.currentPage)}),n.onBeforeUnmount(()=>{M()});const W=()=>{const t=document.querySelector(".crsl__wr");if(!t)return;const r=window.MutationObserver||window.WebKitMutationObserver;e.observer=new r(X),e.observer.observe(t,{subtree:!0,childList:!0,attributes:!0})},M=()=>{e.observer&&(e.observer.disconnect(),e.observer=null),w()},w=()=>{document.removeEventListener("touchmove",m),document.removeEventListener("touchend",p),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)},T=()=>{const t=e.currentPage;t<e.slideEls.length||a.loop?f(t+1):P()},E=()=>{const t=e.currentPage;t>1||a.loop?f(t-1):P()},f=(t,r)=>{e.lastPage=e.currentPage,t===0?e.currentPage=e.slideEls.length:t===e.slideEls.length+1?e.currentPage=1:e.currentPage=t,a.loop?(e.delta===0&&h(v(e.lastPage)),setTimeout(function(){h(v(t)),r||D()},0)):(h(v(t)),r||D())},g=n.computed(()=>a.direction==="horizontal"),C=n.computed(()=>a.direction==="vertical"),k=t=>{e.startPos=B(t),e.delta=0,e.startTranslate=v(e.currentPage),e.startTime=new Date().getTime(),e.dragging=!0,e.transitionDuration=0,document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",p,{passive:!1}),document.addEventListener("mousemove",m,{passive:!1}),document.addEventListener("mouseup",p,{passive:!1})},m=t=>{e.delta=B(t)-e.startPos,a.performanceMode||(h(e.startTranslate+e.delta),s("slider-move",N())),(C||g&&Math.abs(e.delta)>0)&&t.preventDefault()},p=t=>{e.dragging=!1,e.transitionDuration=a.speed;const r=new Date().getTime()-e.startTime<1e3;e.delta<-100||r&&e.delta<-15?T():e.delta>100||r&&e.delta>15?E():P(),w()},H=t=>{a.mousewheelControl&&(e.transitioning||(t.deltaY>0?T():E()),b()&&t.preventDefault())},P=()=>{f(e.currentPage)},B=t=>{const r=g?"pageX":"pageY";return t.changedTouches?t.changedTouches[0][r]:t[r]},D=()=>{e.transitioning=!0,e.transitionDuration=a.speed,b()?s("slide-change-start",e.currentPage):s("slide-revert-start",e.currentPage)},O=()=>{e.transitioning=!1,e.transitionDuration=0,e.delta=0,b()?s("slide-change-end",e.currentPage):s("slide-revert-end",e.currentPage),a.autoHeight&&g&&z(),a.autoWidth&&C&&Y()},z=()=>{const t=c.value;if(!t||!t.children)return;e.currentHeight="auto";const r=[...t.children].filter(i=>![...i.classList].includes("crsl__mirror")),o=getComputedStyle(r[e.currentPage-1],null).getPropertyValue("height");e.transitionDuration=a.speed,n.nextTick(()=>{e.currentHeight=o,setTimeout(()=>{e.transitionDuration=0},a.speed)})},Y=()=>{const t=c.value;if(!t||!t.children)return;e.currentWidth="auto";const r=[...t.children].filter(i=>![...i.classList].includes("crsl__mirror")),o=getComputedStyle(r[e.currentPage-1],null).getPropertyValue("width");e.transitionDuration=a.speed,n.nextTick(()=>{e.currentWidth=o,setTimeout(()=>{e.transitionDuration=0},a.speed)})},b=()=>e.lastPage!==e.currentPage,h=t=>{e[g?"translateX":"translateY"]=t},N=()=>e[g?"translateX":"translateY"],v=t=>{if(t===0)return 0;const r=g?"clientWidth":"clientHeight";return-[].reduce.call(e.slideEls,function(o,i,d){return d>t-2?o:o+i[r]},0)+e.translateOffset},x=()=>{const t=g?"clientWidth":"clientHeight",r=c.value;if(!r)return;const o=r.firstElementChild.cloneNode(!0),i=r.lastElementChild.cloneNode(!0);o.setAttribute("class","crsl__mirror crsl__mirror-first"),i.setAttribute("class","crsl__mirror crsl__mirror-last"),r.insertBefore(i,r.firstElementChild),r.appendChild(o),e.translateOffset=-i[t]},X=(t,r)=>{const o=c.value;if(!o||t.some(d=>d.target===o))return;const i=o.querySelectorAll(".crsl__mirror");if(i&&i.length){for(let d=0,j=i.length>>>0;d<j;d++)n.nextTick(()=>i[d].remove());n.nextTick(()=>x())}};return(t,r)=>(n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["crsl__wrapper",[l.direction,{dragging:n.unref(e).dragging}]]),onTouchstart:k,onMousedown:k,onWheel:H},[n.createElementVNode("div",{class:"crsl__wr",ref:(o,i)=>{i.rf=o,c.value=o},style:n.normalizeStyle({transform:"translate3d("+n.unref(e).translateX+"px,"+n.unref(e).translateY+"px, 0)","transition-duration":n.unref(e).transitionDuration+"ms","max-height":n.unref(e).currentHeight,"max-width":n.unref(e).currentWidth}),onTransitionend:O},[n.renderSlot(t.$slots,"default",{},void 0,!0)],36),n.withDirectives(n.createElementVNode("div",S,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(n.unref(e).slideEls,(o,i)=>(n.openBlock(),n.createElementBlock("span",{class:n.normalizeClass(["crsl__pagination-bullet",{active:i+1===n.unref(e).currentPage}]),style:n.normalizeStyle({background:i+1===n.unref(e).currentPage?l.indicatorTintColor:l.indicatorColor}),key:i,onClick:d=>l.paginationClickable&&f(i+1)},null,14,L))),128))],512),[[n.vShow,l.paginationVisible]])],34))}}),[["__scopeId","data-v-48884066"]]);const V=[y],_=function(l){V.forEach(s=>{l.component(s.name,s)})};typeof window!="undefined"&&window.Vue&&_(window.Vue),u.CarouselView=y,u.default=_,Object.defineProperty(u,"__esModule",{value:!0}),u[Symbol.toStringTag]="Module"});
