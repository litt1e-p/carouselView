"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports[Symbol.toStringTag]="Module";var r=require("vue");const Y={class:"crsl__pagination"},N=["onClick"],X={name:"CarouselView"};var B=((l,s)=>{for(const[a,u]of s)l[a]=u;return l})(Object.assign(X,{props:{direction:{type:String,default:"horizontal",validator:l=>["vertical","horizontal"].indexOf(l)>-1},mousewheelControl:{type:Boolean,default:!0},performanceMode:{type:Boolean,default:!1},paginationVisible:{type:Boolean,default:!0},paginationClickable:{type:Boolean,default:!1},loop:{type:Boolean,default:!0},speed:{type:Number,default:300},autoHeight:{type:Boolean,default:!0},autoWidth:{type:Boolean,default:!0},indicatorColor:{type:String,default:()=>"rgba(153, 153, 153, 0.5)"},indicatorTintColor:{type:String,default:()=>"#007aff"}},emits:["slider-move","slide-change-start","slide-revert-start","slide-change-end","slide-revert-end"],setup:function(l,{emit:s}){const a=l,u=r.ref(null),e=r.reactive({currentPage:1,lastPage:1,translateX:0,translateY:0,startTranslate:0,delta:0,dragging:!1,startPos:null,transitioning:!1,slideEls:[],translateOffset:0,transitionDuration:0,currentHeight:"unset",currentWidth:"unset",startTime:0,observer:void 0});r.onMounted(()=>{e.slideEls=[].map.call(u.value.children,t=>t),a.loop?(r.nextTick(function(){k(),g(e.currentPage,!0)}),S()):g(e.currentPage)}),r.onBeforeUnmount(()=>{L()});const S=()=>{const t=document.querySelector(".crsl__wr");if(!t)return;const n=window.MutationObserver||window.WebKitMutationObserver;e.observer=new n(O),e.observer.observe(t,{subtree:!0,childList:!0,attributes:!0})},L=()=>{e.observer&&(e.observer.disconnect(),e.observer=null),_()},_=()=>{document.removeEventListener("touchmove",m),document.removeEventListener("touchend",f),document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)},b=()=>{const t=e.currentPage;t<e.slideEls.length||a.loop?g(t+1):h()},w=()=>{const t=e.currentPage;t>1||a.loop?g(t-1):h()},g=(t,n)=>{e.lastPage=e.currentPage,t===0?e.currentPage=e.slideEls.length:t===e.slideEls.length+1?e.currentPage=1:e.currentPage=t,a.loop?(e.delta===0&&p(v(e.lastPage)),setTimeout(function(){p(v(t)),n||C()},0)):(p(v(t)),n||C())},d=r.computed(()=>a.direction==="horizontal"),y=r.computed(()=>a.direction==="vertical"),E=t=>{e.startPos=T(t),e.delta=0,e.startTranslate=v(e.currentPage),e.startTime=new Date().getTime(),e.dragging=!0,e.transitionDuration=0,document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",f,{passive:!1}),document.addEventListener("mousemove",m,{passive:!1}),document.addEventListener("mouseup",f,{passive:!1})},m=t=>{e.delta=T(t)-e.startPos,a.performanceMode||(p(e.startTranslate+e.delta),s("slider-move",H())),(y||d&&Math.abs(e.delta)>0)&&t.preventDefault()},f=t=>{e.dragging=!1,e.transitionDuration=a.speed;const n=new Date().getTime()-e.startTime<1e3;e.delta<-100||n&&e.delta<-15?b():e.delta>100||n&&e.delta>15?w():h(),_()},x=t=>{a.mousewheelControl&&(e.transitioning||(t.deltaY>0?b():w()),P()&&t.preventDefault())},h=()=>{g(e.currentPage)},T=t=>{const n=d?"pageX":"pageY";return t.changedTouches?t.changedTouches[0][n]:t[n]},C=()=>{e.transitioning=!0,e.transitionDuration=a.speed,P()?s("slide-change-start",e.currentPage):s("slide-revert-start",e.currentPage)},V=()=>{e.transitioning=!1,e.transitionDuration=0,e.delta=0,P()?s("slide-change-end",e.currentPage):s("slide-revert-end",e.currentPage),a.autoHeight&&d&&W(),a.autoWidth&&y&&M()},W=()=>{const t=u.value;if(!t||!t.children)return;e.currentHeight="auto";const n=[...t.children].filter(o=>![...o.classList].includes("crsl__mirror")),i=getComputedStyle(n[e.currentPage-1],null).getPropertyValue("height");e.transitionDuration=a.speed,r.nextTick(()=>{e.currentHeight=i,setTimeout(()=>{e.transitionDuration=0},a.speed)})},M=()=>{const t=u.value;if(!t||!t.children)return;e.currentWidth="auto";const n=[...t.children].filter(o=>![...o.classList].includes("crsl__mirror")),i=getComputedStyle(n[e.currentPage-1],null).getPropertyValue("width");e.transitionDuration=a.speed,r.nextTick(()=>{e.currentWidth=i,setTimeout(()=>{e.transitionDuration=0},a.speed)})},P=()=>e.lastPage!==e.currentPage,p=t=>{e[d?"translateX":"translateY"]=t},H=()=>e[d?"translateX":"translateY"],v=t=>{if(t===0)return 0;const n=d?"clientWidth":"clientHeight";return-[].reduce.call(e.slideEls,function(i,o,c){return c>t-2?i:i+o[n]},0)+e.translateOffset},k=()=>{const t=d?"clientWidth":"clientHeight",n=u.value;if(!n)return;const i=n.firstElementChild.cloneNode(!0),o=n.lastElementChild.cloneNode(!0);i.setAttribute("class","crsl__mirror crsl__mirror-first"),o.setAttribute("class","crsl__mirror crsl__mirror-last"),n.insertBefore(o,n.firstElementChild),n.appendChild(i),e.translateOffset=-o[t]},O=(t,n)=>{const i=u.value;if(!i||t.some(c=>c.target===i))return;const o=i.querySelectorAll(".crsl__mirror");if(o&&o.length){for(let c=0,z=o.length>>>0;c<z;c++)r.nextTick(()=>o[c].remove());r.nextTick(()=>k())}};return(t,n)=>(r.openBlock(),r.createElementBlock("div",{class:r.normalizeClass(["crsl__wrapper",[l.direction,{dragging:r.unref(e).dragging}]]),onTouchstart:E,onMousedown:E,onWheel:x},[r.createElementVNode("div",{class:"crsl__wr",ref:(i,o)=>{o.rf=i,u.value=i},style:r.normalizeStyle({transform:"translate3d("+r.unref(e).translateX+"px,"+r.unref(e).translateY+"px, 0)","transition-duration":r.unref(e).transitionDuration+"ms","max-height":r.unref(e).currentHeight,"max-width":r.unref(e).currentWidth}),onTransitionend:V},[r.renderSlot(t.$slots,"default",{},void 0,!0)],36),r.withDirectives(r.createElementVNode("div",Y,[(r.openBlock(!0),r.createElementBlock(r.Fragment,null,r.renderList(r.unref(e).slideEls,(i,o)=>(r.openBlock(),r.createElementBlock("span",{class:r.normalizeClass(["crsl__pagination-bullet",{active:o+1===r.unref(e).currentPage}]),style:r.normalizeStyle({background:o+1===r.unref(e).currentPage?l.indicatorTintColor:l.indicatorColor}),key:o,onClick:c=>l.paginationClickable&&g(o+1)},null,14,N))),128))],512),[[r.vShow,l.paginationVisible]])],34))}}),[["__scopeId","data-v-48884066"]]);const q=[B],D=function(l){q.forEach(s=>{l.component(s.name,s)})};typeof window!="undefined"&&window.Vue&&D(window.Vue),exports.CarouselView=B,exports.default=D;
